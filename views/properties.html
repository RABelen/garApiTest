<md-content layout-padding layout="column">
    <md-content layout-padding>
        <div layout-gt-xs="row">
            <div flex-gt-xs>
                <h4>Check-In Date</h4>
                <md-datepicker ng-model="params.check_in"></md-datepicker>
            </div>
            <div flex-gt-xs>
                <h4>Check-Out Date</h4>
                <md-datepicker ng-model="params.check_out"></md-datepicker>
            </div>
        </div>
        <div layout-gt-sm="row">
            <md-input-container class="md-block" flex-gt-sm>
                <label>API Key</label>
                <input ng-model="auth.api_key">
            </md-input-container>

            <md-input-container class="md-block" flex-gt-sm>
                <label>Auth Token</label>
                <input ng-model="auth.auth_token">
            </md-input-container>
        </div>
    </md-content>

    <md-button class="md-raised md-primary" ng-click="fetch(params, rows)" ng-disabled="!rows.length > 0">Query</md-button>

    <md-content layout-padding layout="column" ng-show="hotelsCount > 0">
        <md-list flex>
            <md-subheader class="md-no-sticky">REQUEST OVERVIEW:</md-subheader>
            <md-list-item class="md-3-line">
                <div class="md-list-item-text" layout="column">
                    <p class="md-subhead">Hotels Queried: {{ hotelsCount }}</p>
                    <p class="md-subhead">Rooms Found [Multi-Property]: {{ multiCount }}</p>
                    <p class="md-subhead">Rooms Found [Single Property]: {{ singleCount }}</p>
                    <p class="md-subhead">Rooms Found [Pre-Book]: {{ prebookCount }}</p>
                </div>
            </md-list-item>
        </md-list>
    </md-content>

    <md-card ng-show="res.hotelName" ng-repeat="res in results" ng-init="hotelIndex = $index">
        <md-card-header>
            <md-card-header-text layout="column" ng-class="{withRoom: res.rooms.length > 1, mismatchFound: mismatch}">
                <div layout>
                    <md-button class="md-icon-button" ng-click="roomHide = !roomHide" ng-show="res.rooms.length > 1">
                        <i class="material-icons">keyboard_arrow_down</i>
                    </md-button>
                    <span class="md-headline">{{ hotelIndex + 1 }}. {{ res.hotelName }} </span>
                    <span class="md-headline" ng-show="res.rooms.length > 1"> ({{ res.rooms.length }} rooms found)</span>
                </div>
                <span class="md-subhead">id: {{ res.hotelId }}</span>
            </md-card-header-text>
        </md-card-header>

        <md-card-content layout="column">
            <md-card ng-show="roomHide">
                <md-card-header>
                    <md-card-header-text>
                        <p class="md-headline">Check In Dates : {{ params.check_in | date:'MM/dd/yyyy' }} - {{ params.check_out | date:'MM/dd/yyyy'
                            }}</p>
                    </md-card-header-text>
                </md-card-header>

                <md-card-content layout="column">
                    <md-list class="md-dense" flex ng-repeat="room in res.rooms" ng-init="roomIndex = $index">
                        <md-subheader class="md-no-sticky" ng-show="room.title">
                            <span class="md-subhead">{{ roomIndex + 1 }}. {{ room.title }} (id: {{ room.roomId }})</span>
                            <md-button class="md-primary md-raised" ng-click="rateHide = !rateHide">Show Details</md-button>
                            <md-button class="md-secondary md-raised" ng-href="{{ room.url }}">Open URL</md-button>
                        </md-subheader>

                        <div ng-show="rateHide">
                            <md-list-item class="md-2-line md-long-text">
                                <div class="md-list-item-text" layout="column">
                                    <span class="md-caption">Description:</span>
                                    <p>{{ room.description }}</p>
                                </div>
                            </md-list-item>
                            <md-content layout>
                                <table class="table table-sm table-responsive table-striped table-bordered table-hover">
                                    <thead class="thead-inverse">
                                        <tr>
                                            <th>Request Type</th>
                                            <th>Display Pricing</th>
                                            <th>Rate Plan Code</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="rate in room.rates | orderBy: 'ratePlanCode'">
                                            <div>
                                                <td>{{ rate.requestType }}</td>
                                                <td>{{ rate.displayPrice }}</td>
                                                <td>{{ rate.ratePlanCode }}</td>
                                            </div>
                                        </tr>
                                    </tbody>
                                </table>
                            </md-content>
                        </div>
                    </md-list>
                    <md-divider></md-divider>
                </md-card-content>
            </md-card>
        </md-card-content>
    </md-card>
</md-content>